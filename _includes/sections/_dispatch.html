{%- comment -%}
Static dispatcher for section includes (broad Jekyll compatibility).
Each case delegates to a small, focused template for that section type.
{%- endcomment -%}

{%- case section.type -%}

  {%- when 'practitioner' -%}
    {%- assign slug = page.slug | downcase -%}
    {%- assign one_practitioner = "" | split:"|" -%}
    {%- assign one_practitioner = one_practitioner | push: slug -%}
    {% include sections/practitioners.html section=section practitioners=one_practitioner %}

  {%- when 'practitioners' -%}
    {% include sections/practitioners.html section=section %}

  {%- when 'collection-item' -%}
    {% include sections/collection-item.html section=section data=data %}

  {%- when 'collection-stream' -%}
    {%- assign resolved_filter_values = "" | split: "|" -%}
    {%- for fv in section.data.filter_values -%}
      {%- if fv == "__PAGE_SLUG__" -%}
        {%- assign resolved_filter_values = resolved_filter_values | push: page.slug -%}
      {%- else -%}
        {%- assign resolved_filter_values = resolved_filter_values | push: fv -%}
      {%- endif -%}
    {%- endfor -%}

    {%- include sections/collection-stream.html
      section=section
      collection=section.data.collection
      sort_by=section.data.sort_by
      reverse=section.data.reverse
      excerpt_length=section.data.excerpt_length
      post_display_limit=section.data.post_display_limit
      filter_key=section.data.filter_key
      filter_values=resolved_filter_values
      card_layout=section.data.card_layout
      item_partial=section.data.item_partial
      related_toggle=section.data.related_toggle
      related_toggle_id=section.data.related_toggle_id
    -%}

  {%- when 'ctas' -%}
    {% include sections/ctas.html section=section %}
  
  {%- when 'levels' -%}
    {% include sections/levels.html section=section %}

  {%- when 'markdown' -%}
    {% include sections/markdown.html section=section %}

  {%- when 'text' -%}
    {% include sections/text.html section=section %}

{%- endcase -%}
